
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="🛰️ Process raster data in python">
      
      
        <meta name="author" content="Gonzalo Mateo-García">
      
      
        <link rel="canonical" href="https://spaceml-org.github.io/georeader/modules/geotensor_module/">
      
      
        <link rel="prev" href="../reflectance_module/">
      
      
        <link rel="next" href="../rasterio_reader/">
      
      
      <link rel="icon" href="../../images/logo_georeader.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.43">
    
    
      
        <title>GeoTensor - georeader</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="GeoTensor - georeader" >
      
        <meta  property="og:description"  content="🛰️ Process raster data in python" >
      
        <meta  property="og:image"  content="https://spaceml-org.github.io/georeader/assets/images/social/modules/geotensor_module.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://spaceml-org.github.io/georeader/modules/geotensor_module/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="GeoTensor - georeader" >
      
        <meta  name="twitter:description"  content="🛰️ Process raster data in python" >
      
        <meta  name="twitter:image"  content="https://spaceml-org.github.io/georeader/assets/images/social/modules/geotensor_module.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#geotensor" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="georeader" class="md-header__button md-logo" aria-label="georeader" data-md-component="logo">
      
  <img src="../../images/logo_georeader.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            georeader
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              GeoTensor
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/spaceml-org/georeader" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    spaceml-org/georeader
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="georeader" class="md-nav__button md-logo" aria-label="georeader" data-md-component="logo">
      
  <img src="../../images/logo_georeader.png" alt="logo">

    </a>
    georeader
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/spaceml-org/georeader" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    spaceml-org/georeader
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../read_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoReader concepts and protocols
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../save_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    save
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reflectance_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    reflectance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    GeoTensor
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    GeoTensor
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#georeader.geotensor" class="md-nav__link">
    <span class="md-ellipsis">
      geotensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor" class="md-nav__link">
    <span class="md-ellipsis">
      GeoTensor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeoTensor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.values" class="md-nav__link">
    <span class="md-ellipsis">
      values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      __add__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__and__" class="md-nav__link">
    <span class="md-ellipsis">
      __and__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array__" class="md-nav__link">
    <span class="md-ellipsis">
      __array__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array_finalize__" class="md-nav__link">
    <span class="md-ellipsis">
      __array_finalize__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array_ufunc__" class="md-nav__link">
    <span class="md-ellipsis">
      __array_ufunc__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__ge__" class="md-nav__link">
    <span class="md-ellipsis">
      __ge__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__gt__" class="md-nav__link">
    <span class="md-ellipsis">
      __gt__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__le__" class="md-nav__link">
    <span class="md-ellipsis">
      __le__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__lt__" class="md-nav__link">
    <span class="md-ellipsis">
      __lt__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__mul__" class="md-nav__link">
    <span class="md-ellipsis">
      __mul__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__ne__" class="md-nav__link">
    <span class="md-ellipsis">
      __ne__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__new__" class="md-nav__link">
    <span class="md-ellipsis">
      __new__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__or__" class="md-nav__link">
    <span class="md-ellipsis">
      __or__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__sub__" class="md-nav__link">
    <span class="md-ellipsis">
      __sub__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__truediv__" class="md-nav__link">
    <span class="md-ellipsis">
      __truediv__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.array_as_geotensor" class="md-nav__link">
    <span class="md-ellipsis">
      array_as_geotensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.clip" class="md-nav__link">
    <span class="md-ellipsis">
      clip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.concatenate" class="md-nav__link">
    <span class="md-ellipsis">
      concatenate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.expand_dims" class="md-nav__link">
    <span class="md-ellipsis">
      expand_dims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.footprint" class="md-nav__link">
    <span class="md-ellipsis">
      footprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.invalidmask" class="md-nav__link">
    <span class="md-ellipsis">
      invalidmask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.isel" class="md-nav__link">
    <span class="md-ellipsis">
      isel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.load_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      load_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      load_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.meshgrid" class="md-nav__link">
    <span class="md-ellipsis">
      meshgrid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.pad" class="md-nav__link">
    <span class="md-ellipsis">
      pad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.pad_array" class="md-nav__link">
    <span class="md-ellipsis">
      pad_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.read_from_window" class="md-nav__link">
    <span class="md-ellipsis">
      read_from_window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.resize" class="md-nav__link">
    <span class="md-ellipsis">
      resize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.same_extent" class="md-nav__link">
    <span class="md-ellipsis">
      same_extent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.squeeze" class="md-nav__link">
    <span class="md-ellipsis">
      squeeze
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.stack" class="md-nav__link">
    <span class="md-ellipsis">
      stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.transpose" class="md-nav__link">
    <span class="md-ellipsis">
      transpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.valid_footprint" class="md-nav__link">
    <span class="md-ellipsis">
      valid_footprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.validmask" class="md-nav__link">
    <span class="md-ellipsis">
      validmask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.write_from_window" class="md-nav__link">
    <span class="md-ellipsis">
      write_from_window
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rasterio_reader/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RasterioReader
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rasterize_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rasterize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectorize_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vectorize
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ee_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ee_image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../readers_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    readers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Read overlapping rasters
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Read overlapping rasters
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../read_overlapping_probav_and_sentinel2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overlapping S2 and Proba-V
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reading_overlapping_sentinel2_aviris/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overlapping S2 and AVIRIS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geotensor_numpy_api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoTensor numpy API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/tiling_and_stitching/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tile and stitch AI predictions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sentinel-2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Sentinel-2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sentinel-2/run_in_gee_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From Google Earth Engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../read_S2_SAFE_from_bucket/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    From the public bucket
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sentinel-2/explore_metadata_s2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metadata
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sentinel-2/query_mosaic_s2_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sentinel-2/s2_mosaic_from_gee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosaic from GEE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Sentinel-2/convert_to_radiance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ToA reflectance to radiance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Hyperspectral sensors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Hyperspectral sensors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../emit_explore/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMIT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../simultaneous_prisma_emit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PRISMA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../enmap_with_cloudsen12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EnMAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prisma_with_cloudsen12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PRISMA cloud detection
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" >
        
          
          <label class="md-nav__link" for="__nav_4_6" id="__nav_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Advanced
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../advanced/error_read_write_in_remote_path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VSIL cache problem
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional-features" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Features
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#api-reference" class="md-nav__link">
    <span class="md-ellipsis">
      API Reference
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#georeader.geotensor" class="md-nav__link">
    <span class="md-ellipsis">
      geotensor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor" class="md-nav__link">
    <span class="md-ellipsis">
      GeoTensor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GeoTensor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.values" class="md-nav__link">
    <span class="md-ellipsis">
      values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__add__" class="md-nav__link">
    <span class="md-ellipsis">
      __add__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__and__" class="md-nav__link">
    <span class="md-ellipsis">
      __and__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array__" class="md-nav__link">
    <span class="md-ellipsis">
      __array__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array_finalize__" class="md-nav__link">
    <span class="md-ellipsis">
      __array_finalize__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__array_ufunc__" class="md-nav__link">
    <span class="md-ellipsis">
      __array_ufunc__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__ge__" class="md-nav__link">
    <span class="md-ellipsis">
      __ge__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__gt__" class="md-nav__link">
    <span class="md-ellipsis">
      __gt__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__le__" class="md-nav__link">
    <span class="md-ellipsis">
      __le__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__lt__" class="md-nav__link">
    <span class="md-ellipsis">
      __lt__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__mul__" class="md-nav__link">
    <span class="md-ellipsis">
      __mul__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__ne__" class="md-nav__link">
    <span class="md-ellipsis">
      __ne__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__new__" class="md-nav__link">
    <span class="md-ellipsis">
      __new__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__or__" class="md-nav__link">
    <span class="md-ellipsis">
      __or__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__sub__" class="md-nav__link">
    <span class="md-ellipsis">
      __sub__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.__truediv__" class="md-nav__link">
    <span class="md-ellipsis">
      __truediv__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.array_as_geotensor" class="md-nav__link">
    <span class="md-ellipsis">
      array_as_geotensor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.clip" class="md-nav__link">
    <span class="md-ellipsis">
      clip
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.concatenate" class="md-nav__link">
    <span class="md-ellipsis">
      concatenate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.expand_dims" class="md-nav__link">
    <span class="md-ellipsis">
      expand_dims
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.footprint" class="md-nav__link">
    <span class="md-ellipsis">
      footprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.invalidmask" class="md-nav__link">
    <span class="md-ellipsis">
      invalidmask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.isel" class="md-nav__link">
    <span class="md-ellipsis">
      isel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.load_bytes" class="md-nav__link">
    <span class="md-ellipsis">
      load_bytes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.load_file" class="md-nav__link">
    <span class="md-ellipsis">
      load_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.meshgrid" class="md-nav__link">
    <span class="md-ellipsis">
      meshgrid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.pad" class="md-nav__link">
    <span class="md-ellipsis">
      pad
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.pad_array" class="md-nav__link">
    <span class="md-ellipsis">
      pad_array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.read_from_window" class="md-nav__link">
    <span class="md-ellipsis">
      read_from_window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.resize" class="md-nav__link">
    <span class="md-ellipsis">
      resize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.same_extent" class="md-nav__link">
    <span class="md-ellipsis">
      same_extent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.squeeze" class="md-nav__link">
    <span class="md-ellipsis">
      squeeze
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.stack" class="md-nav__link">
    <span class="md-ellipsis">
      stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.transpose" class="md-nav__link">
    <span class="md-ellipsis">
      transpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.valid_footprint" class="md-nav__link">
    <span class="md-ellipsis">
      valid_footprint
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.validmask" class="md-nav__link">
    <span class="md-ellipsis">
      validmask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#georeader.geotensor.GeoTensor.write_from_window" class="md-nav__link">
    <span class="md-ellipsis">
      write_from_window
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="geotensor">GeoTensor<a class="headerlink" href="#geotensor" title="Permanent link">&para;</a></h1>
<p>The <code>GeoTensor</code> class is a subclass of <code>np.ndarray</code> that stores the spatial affine transform, the coordinate reference system (<code>crs</code>) and no data value (called <code>fill_value_default</code>). When a <code>GeoTensor</code> is sliced, its <code>transform</code> attribute is shifted accordingly. Additionally its transform is also shifted if the <code>GeoTensor</code> is padded. <code>GeoTensor</code>s are restricted to be 2D, 3D or 4D arrays and their two last dimensions are assumed to be the <code>y</code> and <code>x</code> spatial axis.</p>
<p><code>GeoTensor</code> implements the <a href="../read_module/#geodata-protocol">GeoData protocol</a>. This makes it fully compatible with all <a href="../read_module/#read-methods"><code>read_*</code> methods</a> in the library, allowing for operations like reprojection, subseting from spatial coordinates, mosaicking or vectorization.</p>
<p>For a detailed guide on working with the NumPy API in GeoTensors, see the <a href="../../geotensor_numpy_api/">GeoTensor NumPy API tutorial</a> which covers slicing, operations, masking, and more practical examples.</p>
<p>As a subclass of <code>np.ndarray</code>, operations with <code>GeoTensor</code> objects work similar than operations with <code>np.ndarray</code>s. However, there are some restrictions that we have implemented to keep consistency with the <code>GeoTensor</code> concept. If you need to use the <code>numpy</code> implementation you can access the bare <code>numpy</code> object with the <code>.values</code> attribute. Below there's a list with restrictions on <code>numpy</code> operations:</p>
<ol>
<li>
<p>Slicing a <code>GeoTensor</code> is more restrictive than a <code>numpy</code> array. It only allows to slice with <code>lists</code>, numbers or <code>slice</code>s. In particular the spatial dimensions can only be sliced with <code>slice</code>s. Slicing for inplace modification is not restricted (i.e. you can slice with boolean arrays to modify certain values of the object). See <a href="#georeader.geotensor.GeoTensor.isel">isel</a> and <a href="#georeader.geotensor.GeoTensor.__getitem__"><strong>getitem</strong></a> methods.</p>
</li>
<li>
<p>Binary operations (such as add <a href="#georeader.geotensor.GeoTensor.__add__"><strong>add</strong></a>, multiply <a href="#georeader.geotensor.GeoTensor.__mul__"><strong>mul</strong></a>, <a href="#georeader.geotensor.GeoTensor.__eq__">==</a>, <a href="#georeader.geotensor.GeoTensor.__or__">|</a> etc) check, for <code>GeoTensor</code> inputs, if they have the <a href="#georeader.geotensor.GeoTensor.same_extent">same_extent</a>; that is, same <code>transform</code> <code>crs</code> and spatial dimensions (<code>width</code> and <code>height</code>).</p>
</li>
<li>
<p><a href="#georeader.geotensor.GeoTensor.squeeze">squeeze</a>, <a href="#georeader.geotensor.GeoTensor.expand_dims">expand_dims</a> and <a href="#georeader.geotensor.GeoTensor.transpose">transpose</a> make sure spatial dimensions (last two axes) are not modified and kept at the end of the array.</p>
</li>
<li>
<p><a href="#georeader.geotensor.GeoTensor.concatenate">concatenate</a> and <a href="#georeader.geotensor.GeoTensor.stack">stack</a> make sure all operated <code>GeoTensor</code>s have <code>same_extent</code> and <code>shape</code>. <code>concatenate</code> does not allow to concatenate on the spatial dims.</p>
</li>
<li>
<p>Reductions (such as <code>np.mean</code> or <code>np.all</code>) return <code>GeoTensor</code> object if the spatial dimensions are preserved and <code>np.ndarray</code> or scalars otherwise. This is handled by the <a href="#georeader.geotensor.GeoTensor.__array_ufunc__"><strong>array_ufunc</strong></a> method.</p>
</li>
</ol>
<h2 id="additional-features">Additional Features<a class="headerlink" href="#additional-features" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Masking utilities</strong>: Methods like <a href="#georeader.geotensor.GeoTensor.validmask">validmask()</a> and <a href="#georeader.geotensor.GeoTensor.invalidmask">invalidmask()</a> create boolean masks based on the <code>fill_value_default</code>.</li>
<li><strong>Window-based access</strong>: <a href="#georeader.geotensor.GeoTensor.read_from_window">read_from_window()</a> and <a href="#georeader.geotensor.GeoTensor.write_from_window">write_from_window()</a> provide window-based operations using rasterio's window system.</li>
<li><strong>File I/O</strong>: Class methods <a href="#georeader.geotensor.GeoTensor.load_file">load_file()</a> and <a href="#georeader.geotensor.GeoTensor.load_bytes">load_bytes()</a> for easily loading GeoTensors from files or memory.</li>
<li><strong>Footprint extraction</strong>: Methods to extract the valid data footprint as vector geometries (<a href="#georeader.geotensor.GeoTensor.footprint">footprint()</a> and <a href="#georeader.geotensor.GeoTensor.valid_footprint">valid_footprint()</a>).</li>
<li><strong>Coordinate transformation</strong>: The <a href="#georeader.geotensor.GeoTensor.meshgrid">meshgrid()</a> method creates coordinate arrays for the spatial dimensions.</li>
<li><strong>Resizing</strong>: The <a href="#georeader.geotensor.GeoTensor.resize">resize()</a> method changes the spatial resolution while maintaining geospatial information correct (i.e. changing the spatial resolution of the <code>transform</code>).</li>
<li><strong>Metadata storage</strong>: GeoTensor includes an <code>attrs</code> dictionary for storing additional metadata like tags and band descriptions.</li>
</ul>
<h2 id="api-reference">API Reference<a class="headerlink" href="#api-reference" title="Permanent link">&para;</a></h2>


<div class="doc doc-object doc-module">



<a id="georeader.geotensor"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="georeader.geotensor.GeoTensor" class="doc doc-heading">
            <code>GeoTensor</code>


<a href="#georeader.geotensor.GeoTensor" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="numpy.ndarray">ndarray</span></code></p>


        <p>This class is a wrapper around a numpy tensor with geospatial information.
It can store 2D, 3D or 4D tensors. The last two dimensions are the spatial dimensions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="georeader.geotensor.Tensor">Tensor</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy or torch tensor (2D, 3D or 4D).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform</code>
            </td>
            <td>
                  <code><span title="rasterio.Affine">Affine</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>affine geospatial transform</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_value_default</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[int, float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to fill when
reading out of bounds. Could be None. Defaults to 0.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor.values" href="#georeader.geotensor.GeoTensor.values">values</a></code></td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy or torch tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.transform">transform</span></code></td>
            <td>
                  <code><span title="rasterio.Affine">Affine</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>affine geospatial transform</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.crs">crs</span></code></td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.fill_value_default">fill_value_default</span></code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[int, float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to fill when
reading out of bounds. Could be None. Defaults to 0.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.shape">shape</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>shape of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.res">res</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>resolution of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.dtype">dtype</span></code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>data type of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.height">height</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>height of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.width">width</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>width of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.count">count</span></code></td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>number of bands in the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.bounds">bounds</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, float, float, float]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bounds of the tensor</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.dims">dims</span></code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>names of the dimensions</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="georeader.geotensor.GeoTensor.attrs">attrs</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with the attributes of the GeoTensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">transform</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crs</span> <span class="o">=</span> <span class="s2">&quot;EPSG:4326&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
</code></pre></div>






              <details class="quote">
                <summary>Source code in <code>georeader/geotensor.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a wrapper around a numpy tensor with geospatial information.</span>
<span class="sd">    It can store 2D, 3D or 4D tensors. The last two dimensions are the spatial dimensions.</span>

<span class="sd">    Args:</span>
<span class="sd">        values (Tensor): numpy or torch tensor (2D, 3D or 4D).</span>
<span class="sd">        transform (rasterio.Affine): affine geospatial transform</span>
<span class="sd">        crs (Any): coordinate reference system</span>
<span class="sd">        fill_value_default (Optional[Union[int, float]], optional): Value to fill when</span>
<span class="sd">            reading out of bounds. Could be None. Defaults to 0.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        values (NDArray): numpy or torch tensor</span>
<span class="sd">        transform (rasterio.Affine): affine geospatial transform</span>
<span class="sd">        crs (Any): coordinate reference system</span>
<span class="sd">        fill_value_default (Optional[Union[int, float]], optional): Value to fill when</span>
<span class="sd">            reading out of bounds. Could be None. Defaults to 0.</span>
<span class="sd">        shape (Tuple): shape of the tensor</span>
<span class="sd">        res (Tuple[float, float]): resolution of the tensor</span>
<span class="sd">        dtype: data type of the tensor</span>
<span class="sd">        height (int): height of the tensor</span>
<span class="sd">        width (int): width of the tensor</span>
<span class="sd">        count (int): number of bands in the tensor</span>
<span class="sd">        bounds (Tuple[float, float, float, float]): bounds of the tensor</span>
<span class="sd">        dims (Tuple[str]): names of the dimensions</span>
<span class="sd">        attrs (Dict[str, Any]): dictionary with the attributes of the GeoTensor</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; transform = rasterio.Affine(1, 0, 0, 0, -1, 0)</span>
<span class="sd">        &gt;&gt;&gt; crs = &quot;EPSG:4326&quot;</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">values</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
        <span class="n">transform</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="p">,</span>
        <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">attrs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This class is a wrapper around a numpy or torch tensor with geospatial information.</span>

<span class="sd">        Args:</span>
<span class="sd">            values (NDArray): numpy or torch tensor</span>
<span class="sd">            transform (rasterio.Affine): affine geospatial transform</span>
<span class="sd">            crs (Any): coordinate reference system</span>
<span class="sd">            fill_value_default (Optional[Union[int, float]], optional): Value to fill when</span>
<span class="sd">                reading out of bounds. Could be None. Defaults to 0.</span>
<span class="sd">            attrs (Optional[Dict[str, Any]], optional): dictionary with the attributes of the GeoTensor</span>
<span class="sd">                Defaults to None.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: when the shape of the tensor is not 2d, 3d or 4d.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">fill_value_default</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected 2d-4d array found </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span> <span class="k">if</span> <span class="n">attrs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Self</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize attributes when a new GeoTensor is created from an existing array.</span>

<span class="sd">        This method is called whenever a new array object is created from an existing array</span>
<span class="sd">        (e.g., through slicing, view casting, or copy operations).</span>

<span class="sd">        Args:</span>
<span class="sd">            obj (Optional[np.ndarray]): The array object from which the new array is created.</span>
<span class="sd">                                       Can be None if the array is being created from scratch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;fill_value_default&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;fill_value_default&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle NumPy universal functions applied to this GeoTensor.</span>

<span class="sd">        This method is called when a NumPy universal function (ufunc) is applied to the GeoTensor.</span>
<span class="sd">        It converts GeoTensor inputs to NumPy arrays, applies the ufunc, and converts array results</span>
<span class="sd">        back to GeoTensor objects with the same geospatial metadata.</span>

<span class="sd">        Args:</span>
<span class="sd">            ufunc (np.ufunc): The NumPy universal function being applied</span>
<span class="sd">            method (str): The method of the ufunc (&#39;__call__&#39;, &#39;reduce&#39;, etc.)</span>
<span class="sd">            *inputs: The input arrays to the ufunc</span>
<span class="sd">            **kwargs: Additional keyword arguments to the ufunc</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[GeoTensor, NDArray]: If the result is an array, returns a new GeoTensor with the same</span>
<span class="sd">                                  geospatial attributes. Otherwise, returns the original result.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Normal processing for most operations</span>
        <span class="n">inputs_arr</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span>
        <span class="p">)</span>
        <span class="c1"># Handle &#39;out&#39; argument if present</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">out_arrays</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
            <span class="c1"># Convert GeoTensor outputs to regular arrays</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">out_arrays</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="n">o</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_arrays</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">out</span><span class="p">,)</span>
                <span class="p">)</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_arrays</span>

        <span class="c1"># Delegate to numpy&#39;s implementation</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__array_ufunc__</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs_arr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">cast_to_geotensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preserved_spatial</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Propagate metadata to output arrays</span>
        <span class="k">if</span> <span class="n">out_arrays</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">o_orig</span><span class="p">,</span> <span class="n">o_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">out</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">out</span><span class="p">],</span> <span class="n">out_arrays</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">cast_to_geotensor</span>
                    <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_orig</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span>
                    <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">o_new</span> <span class="o">=</span> <span class="n">o_orig</span><span class="o">.</span><span class="n">array_as_geotensor</span><span class="p">(</span><span class="n">o_new</span><span class="p">)</span>

        <span class="c1"># Normal ufunc processing for other cases</span>
        <span class="k">if</span> <span class="n">cast_to_geotensor</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_as_geotensor</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">_preserved_spatial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Special handling for reduction operations (sum, mean, max, etc.)&quot;&quot;&quot;</span>
        <span class="c1"># Extract reduction axis (default is flattening)</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">!=</span> <span class="s2">&quot;reduce&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># No reduction, preserve spatial dims</span>

        <span class="n">axis</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;axis&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Check if reduction preserves spatial structure (last 2 dims untouched)</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">preserve_spatial</span> <span class="o">=</span> <span class="n">axis</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># tuple of axes</span>
                <span class="n">preserve_spatial</span> <span class="o">=</span> <span class="nb">all</span><span class="p">(</span>
                    <span class="n">ax</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">preserve_spatial</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Full reduction eliminates all dims</span>

        <span class="c1"># For full reductions or spatial dim reductions, return plain array/scalar</span>
        <span class="k">return</span> <span class="n">preserve_spatial</span>

    <span class="k">def</span> <span class="nf">array_as_geotensor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">result</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Self</span><span class="p">],</span>
        <span class="n">fill_value_default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a NumPy array result back to a GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            result (Union[np.ndarray, Self]): Any NumPy array or GeoTensor.</span>
<span class="sd">            fill_value_default: fill value for the returned GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self: A new GeoTensor with the same geospatial attributes as the original.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Propagate metadata for array results</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Operation altered spatial dimensions!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">fill_value_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span>
                <span class="n">result</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
                <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the GeoTensor to a standard NumPy array.</span>

<span class="sd">        This method is called by np.asarray() and most NumPy functions to get</span>
<span class="sd">        the underlying NumPy array representation of this object.</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype (Optional[np.dtype]): The desired data type for the returned array.</span>
<span class="sd">                                       If None, the array&#39;s current dtype is preserved.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: A NumPy array view of this GeoTensor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a view of the array (memory shared with original)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dims</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="c1"># TODO allow different ordering of dimensions?</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;band&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unexpected 2d-4d array found </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">dims</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;values&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;transform&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">a</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">b</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">c</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">d</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">e</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;crs&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">),</span>
            <span class="s2">&quot;fill_value_default&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">json</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">]),</span>
            <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="p">(</span><span class="o">*</span><span class="n">json</span><span class="p">[</span><span class="s2">&quot;transform&quot;</span><span class="p">]),</span>
            <span class="n">json</span><span class="p">[</span><span class="s2">&quot;crs&quot;</span><span class="p">],</span>
            <span class="n">json</span><span class="p">[</span><span class="s2">&quot;fill_value_default&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">res</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">res</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">dtype</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">count</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">window_bounds</span><span class="p">(</span>
            <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
                <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span>
            <span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

    <span class="c1"># Not needed due to ufunc implementation?</span>
    <span class="c1"># def astype(self, dtype) -&gt; Self:</span>
    <span class="c1">#     return GeoTensor(</span>
    <span class="c1">#         self.values.astype(dtype), self.transform, self.crs, self.fill_value_default</span>
    <span class="c1">#     )</span>

    <span class="k">def</span> <span class="nf">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a meshgrid of spatial dimensions of the GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            dst_crs (Optional[Any], optional): output coordinate reference system. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[NDArray, NDArray]: 2D arrays of xs and ys coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">georeader</span> <span class="kn">import</span> <span class="n">griddata</span>

        <span class="k">return</span> <span class="n">griddata</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="n">source_crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">dst_crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">same_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if two GeoTensors have the same georeferencing (crs, transform and spatial dimensions).</span>

<span class="sd">        Args:</span>
<span class="sd">            other (GeoTensor | GeoData): GeoTensor to compare with. Other GeoData object can be passed (it requires crs, transform and shape attributes)</span>
<span class="sd">            precision (float, optional): precision to compare the transform. Defaults to 1e-3.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if both GeoTensors have the same georeferencing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">almost_equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">compare_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (GeoTensor): GeoTensor to add.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match.</span>
<span class="sd">            TypeError: if other is not a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the addition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for addition. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Substract two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (GeoTensor): GeoTensor to add.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match.</span>
<span class="sd">            TypeError: if other is not a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the substraction.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for substraction. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Multiply two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (GeoTensor): GeoTensor to add.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match.</span>
<span class="sd">            TypeError: if other is not a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the multiplication.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for multiplication. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divide two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (GeoTensor): GeoTensor to add.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match.</span>
<span class="sd">            TypeError: if other is not a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the division.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for division. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform bitwise AND operation between two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): GeoTensor or array-like to AND with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match when other is a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the bitwise AND operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for bitwise AND. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&amp;</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform bitwise OR operation between two GeoTensors. The georeferencing must match.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): GeoTensor or array-like to OR with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the georeferencing does not match when other is a GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the result of the bitwise OR operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for bitwise OR. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">|</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise equality comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating equality.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise inequality comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating inequality.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise less than comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating less than relationship.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise less than or equal comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating less than or equal relationship.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise greater than comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating greater than relationship.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element-wise greater than or equal comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">        The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with boolean values indicating greater than or equal relationship.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                    <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                    <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
                <span class="p">)</span>

        <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;=</span> <span class="n">other</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Remove single-dimensional entries from the shape of the GeoTensor values.</span>
<span class="sd">        It does not squeeze the spatial dimensions (last two dimensions).</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the squeezed values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="p">(</span><span class="n">axis</span><span class="p">,)</span>
            <span class="c1"># Check if spatial dimesions will be squeezed</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Cannot squeeze spatial dimensions. &quot;</span>
                        <span class="s2">&quot;Use `squeeze(axis=0)` to squeeze the first dimension.&quot;</span>
                    <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;Cannot squeeze spatial dimensions. &quot;</span>
                        <span class="s2">&quot;Use `squeeze(axis=0)` to squeeze the first dimension.&quot;</span>
                    <span class="p">)</span>

        <span class="c1"># squeeze all but last two dimensions</span>
        <span class="n">squeezed_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">squeezed_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Expand the dimensions of the GeoTensor values while preserving the spatial dimensions.</span>

<span class="sd">        This method ensures that no dimensions are added after or in between the spatial dimensions</span>
<span class="sd">        (which are always the last two dimensions).</span>

<span class="sd">        Args:</span>
<span class="sd">            axis (Union[int, tuple]): Position or positions where new axes should be inserted.</span>
<span class="sd">                Must be less than the number of dimensions minus 2 (to preserve spatial dims).</span>
<span class="sd">                Positions are counted from the first dimension.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the expanded values.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If trying to add dimensions at or after the spatial dimensions.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; # Add a new dimension at axis 0</span>
<span class="sd">            &gt;&gt;&gt; gt_expanded = gt.expand_dims(0)</span>
<span class="sd">            &gt;&gt;&gt; assert gt_expanded.shape == (1, 3, 100, 100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1"># Check if axis is valid (not interfering with spatial dimensions)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot add dimension at or after spatial dimensions. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Axis must be &lt; </span><span class="si">{</span><span class="n">ndim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> or &gt;= </span><span class="si">{</span><span class="o">-</span><span class="n">ndim</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="c1"># Convert negative axis to positive</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">axis</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">+</span> <span class="n">axis</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># tuple of axes</span>
            <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ax</span> <span class="o">&gt;=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">ax</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ndim</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Cannot add dimension at or after spatial dimensions. &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;All axes must be &lt; </span><span class="si">{</span><span class="n">ndim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> or &gt;= </span><span class="si">{</span><span class="o">-</span><span class="n">ndim</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">ax</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

        <span class="c1"># Use numpy expand_dims to add the new dimensions</span>
        <span class="n">expanded_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">expanded_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span> <span class="n">a_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clip the GeoTensor values between the GeoTensor min and max values.</span>

<span class="sd">        Args:</span>
<span class="sd">            a_min (float): Minimum value.</span>
<span class="sd">            a_max (float): Maximum value.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the clipped values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">clipped_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">clipped_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the values of the GeoTensor using the given key.</span>

<span class="sd">        Args:</span>
<span class="sd">            key: Key to index the GeoTensor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the selected values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>

        <span class="n">sel_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Adding axis is not permitted to GeoTensors. Use `expand_dims`&quot;</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="o">...</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Using elipsis is not permitted with GeoTensors. Use `values` attribute&quot;</span>
                    <span class="p">)</span>
                <span class="n">sel_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sel_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">isel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sel</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Slicing with dict. Spatial dimensions can only be sliced with slices.</span>

<span class="sd">        Args:</span>
<span class="sd">            sel: Dict with slice selection; i.e. `{&quot;x&quot;: slice(10, 20), &quot;y&quot;: slice(20, 340)}`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor with the sliced values.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt.isel({&quot;x&quot;: slice(10, 20), &quot;y&quot;: slice(20, 340)})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">slice_tuple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>

        <span class="c1"># Compùte the window to shift the transform</span>
        <span class="n">slices_window</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">slice</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Only slice selection supported for x, y dims, found </span><span class="si">{</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
                <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

        <span class="n">window_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">from_slices</span><span class="p">(</span>
            <span class="o">*</span><span class="n">slices_window</span><span class="p">,</span> <span class="n">boundless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span>
        <span class="p">)</span>

        <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">window_current</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
        <span class="p">)</span>

        <span class="c1"># Scale the spatial transform if the step of the slices &gt; 1</span>
        <span class="n">step_rows</span> <span class="o">=</span> <span class="n">slices_window</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step</span>
        <span class="n">step_cols</span> <span class="o">=</span> <span class="n">slices_window</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">step</span>
        <span class="k">if</span> <span class="n">step_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">step_rows</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">step_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">step_cols</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">step_rows</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">step_cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">transform_current</span> <span class="o">=</span> <span class="n">transform_current</span> <span class="o">*</span> <span class="n">Affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">step_cols</span><span class="p">,</span> <span class="n">step_rows</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slice_tuple</span><span class="p">],</span>
            <span class="n">transform_current</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_slice_tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sel</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">slice_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
                <span class="n">slice_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">slice_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">slice_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">footprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Polygon</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the footprint of the GeoTensor as a Polygon.</span>

<span class="sd">        Args:</span>
<span class="sd">            crs (Optional[str], optional): Coordinate reference system. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Polygon: footprint of the GeoTensor.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt.footprint(crs=&quot;EPSG:4326&quot;) # returns a Polygon in WGS84</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pol</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">window_polygon</span><span class="p">(</span>
            <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
                <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">compare_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">pol</span>

        <span class="k">return</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">polygon_to_crs</span><span class="p">(</span><span class="n">pol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">valid_footprint</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        vectorizes the valid values of the GeoTensor and returns the footprint as a Polygon.</span>

<span class="sd">        Args:</span>
<span class="sd">            crs (Optional[str], optional): Coordinate reference system. Defaults to None.</span>
<span class="sd">            method (str, optional): &quot;all&quot; or &quot;any&quot; to aggregate the channels of the image. Defaults to &quot;all&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Polygon or MultiPolygon: footprint of the GeoTensor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">valid_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">valid_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
                    <span class="n">valid_values</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;any&quot;</span><span class="p">:</span>
                <span class="n">valid_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span>
                    <span class="n">valid_values</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> to aggregate channels not implemented&quot;</span>
                <span class="p">)</span>

        <span class="kn">from</span> <span class="nn">georeader</span> <span class="kn">import</span> <span class="n">vectorize</span>

        <span class="n">polygons</span> <span class="o">=</span> <span class="n">vectorize</span><span class="o">.</span><span class="n">get_polygons</span><span class="p">(</span><span class="n">valid_values</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;GeoTensor has no valid values&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pol</span> <span class="o">=</span> <span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pol</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">pol</span>

        <span class="k">return</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">polygon_to_crs</span><span class="p">(</span><span class="n">pol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot; </span>
<span class="s2">         Transform: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="si">}</span>
<span class="s2">         Shape: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span>
<span class="s2">         Resolution: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">res</span><span class="si">}</span>
<span class="s2">         Bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span>
<span class="s2">         CRS: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="si">}</span>
<span class="s2">         fill_value_default: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pad_width</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span>
        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pad the GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            pad_width (Union[Dict[str, Tuple[int, int]], List[Tuple[int, int]]]):</span>
<span class="sd">                dictionary with Tuple to pad for each dimension</span>
<span class="sd">                `{&quot;x&quot;: (pad_x_0, pad_x_1), &quot;y&quot;: (pad_y_0, pad_y_1)}` or list of tuples</span>
<span class="sd">                `[(pad_x_0, pad_x_1), (pad_y_0, pad_y_1)]`.</span>
<span class="sd">            mode (str, optional): pad mode (see np.pad or torch.nn.functional.pad). Defaults to &quot;constant&quot;.</span>
<span class="sd">            kwargs: additional arguments for the pad function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: padded GeoTensor.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pad_width</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span><span class="si">}</span><span class="s2"> pad widths found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pad_width</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">pad_width_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
                <span class="n">pad_width_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pad_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad_width_dict</span> <span class="o">=</span> <span class="n">pad_width</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_array</span><span class="p">(</span><span class="n">pad_width_dict</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pad_array</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">pad_width</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
        <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
        <span class="n">constant_values</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Pad the GeoTensor.</span>

<span class="sd">        Args:</span>
<span class="sd">            pad_width (_type_, optional):  dictionary with Tuple to pad for each dimension</span>
<span class="sd">                `{&quot;x&quot;: (pad_x_0, pad_x_1), &quot;y&quot;: (pad_y_0, pad_y_1)}`.</span>
<span class="sd">            mode (str, optional): pad mode (see np.pad or torch.nn.functional.pad). Defaults to &quot;constant&quot;.</span>
<span class="sd">            constant_values (Any, optional): _description_. Defaults to `self.fill_value_default`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: padded GeoTensor.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt.pad_array({&quot;x&quot;: (10, 10), &quot;y&quot;: (10, 10)})</span>
<span class="sd">            &gt;&gt;&gt; assert gt.shape == (3, 120, 120)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">constant_values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Mode constant either requires constant_values passed or fill_value_default not None in current GeoTensor&quot;</span>
                <span class="p">)</span>
            <span class="n">constant_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>

        <span class="n">pad_list_np</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">:</span>
                <span class="n">pad_list_np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pad_list_np</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

        <span class="n">kwargs_extra</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
            <span class="n">kwargs_extra</span><span class="p">[</span><span class="s2">&quot;constant_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">constant_values</span>
        <span class="n">values_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pad_list_np</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_extra</span><span class="p">)</span>

        <span class="c1"># Compute the new transform</span>
        <span class="n">slices_window</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">:</span>
                <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span> <span class="o">+</span> <span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

        <span class="n">window_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">from_slices</span><span class="p">(</span>
            <span class="o">*</span><span class="n">slices_window</span><span class="p">,</span> <span class="n">boundless</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">window_current</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">values_new</span><span class="p">,</span>
            <span class="n">transform_current</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">resolution_dst</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">anti_aliasing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">anti_aliasing_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
        <span class="n">mode_pad</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resize the geotensor to match a certain size output_shape. This function works with GeoTensors of 2D, 3D and 4D.</span>
<span class="sd">        The geoinformation of the output tensor is changed accordingly.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_shape: output spatial shape if None resolution_dst must be provided. If not provided,</span>
<span class="sd">                the output shape is computed from the resolution_dst rounding to the closest integer.</span>
<span class="sd">            resolution_dst: output resolution if None output_shape must be provided.</span>
<span class="sd">            anti_aliasing: Whether to apply a Gaussian filter to smooth the image prior to downsampling</span>
<span class="sd">            anti_aliasing_sigma:  anti_aliasing_sigma : {float}, optional</span>
<span class="sd">                Standard deviation for Gaussian filtering used when anti-aliasing.</span>
<span class="sd">                By default, this value is chosen as (s - 1) / 2 where s is the</span>
<span class="sd">                downsampling factor, where s &gt; 1</span>
<span class="sd">            interpolation: Algorithm used for resizing: &#39;nearest&#39; | &#39;bilinear&#39; | &#39;bicubic&#39;</span>
<span class="sd">            mode_pad: mode pad for resize function</span>

<span class="sd">        Returns:</span>
<span class="sd">             resized GeoTensor</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; resized = gt.resize((50, 50))</span>
<span class="sd">            &gt;&gt;&gt; assert resized.shape == (3, 50, 50)</span>
<span class="sd">            &gt;&gt;&gt; assert resized.res == (2*gt.res[0], 2*gt.res[1])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">spatial_shape</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
        <span class="n">resolution_or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span>

        <span class="k">if</span> <span class="n">output_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">resolution_dst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t have output_shape and resolution_dst as None&quot;</span>
            <span class="n">output_shape</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                <span class="nb">round</span><span class="p">(</span><span class="n">spatial_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">spatial_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">resolution_dst</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Both output_shape and resolution_dst can&#39;t be provided&quot;</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">output_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expected output shape to be the spatial dimensions found: </span><span class="si">{</span><span class="n">output_shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">resolution_dst</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">spatial_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">spatial_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>

        <span class="c1"># Compute output transform</span>
        <span class="n">transform_scale</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
            <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">*</span> <span class="n">transform_scale</span>

        <span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">resize</span>

        <span class="c1"># https://scikit-image.org/docs/stable/api/skimage.transform.html#skimage.transform.resize</span>
        <span class="n">output_tensor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">output_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="ow">not</span> <span class="n">anti_aliasing</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">anti_aliasing_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
                <span class="n">output_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
                    <span class="n">output_shape</span><span class="p">,</span>
                    <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
                    <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
                    <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
                    <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma_iter</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="p">(</span><span class="ow">not</span> <span class="n">anti_aliasing</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="p">(</span><span class="n">anti_aliasing_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">output_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                    <span class="n">output_shape</span><span class="p">,</span>
                    <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
                    <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
                    <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
                    <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma_iter</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_tensor</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">output_shape</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
                <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
                <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
                <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">output_tensor</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Permute the dimensions of the GeoTensor while keeping the spatial dimensions at the end.</span>

<span class="sd">        Args:</span>
<span class="sd">            axes (tuple, optional): If specified, it must be a tuple or list of axes. The last two</span>
<span class="sd">                values must be the original spatial dimensions indices (ndim-2, ndim-1).</span>
<span class="sd">                If None, the non-spatial dimensions are reversed while spatial dimensions remain at the end.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: A view of the array with dimensions transposed.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the spatial dimensions are moved from their last positions.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 4, 100, 200), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; # Shape is (3, 4, 100, 200)</span>
<span class="sd">            &gt;&gt;&gt; gt_t = gt.transpose()</span>
<span class="sd">            &gt;&gt;&gt; # Shape is now (4, 3, 100, 200)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # You can also specify axes explicitly:</span>
<span class="sd">            &gt;&gt;&gt; gt_t = gt.transpose((1, 0, 2, 3))  # Valid: spatial dims remain at end</span>
<span class="sd">            &gt;&gt;&gt; # But this would raise an error:</span>
<span class="sd">            &gt;&gt;&gt; # gt.transpose((0, 2, 1, 3))  # Invalid: spatial dims must stay at end</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># Nothing meaningful to transpose for arrays with only spatial dimensions</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Original spatial dimensions indices</span>
        <span class="n">y_dim</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">x_dim</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Reverse all dimensions except the spatial ones which stay at the end</span>
            <span class="n">non_spatial_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
            <span class="n">non_spatial_axes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">non_spatial_axes</span> <span class="o">+</span> <span class="p">[</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert to tuple if necessary</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

            <span class="c1"># Check if axes has the right length</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;axes should contain </span><span class="si">{</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Check if the last two values in axes are the spatial dimensions</span>
            <span class="k">if</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot change the position of spatial dimensions. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;The last two axes must be </span><span class="si">{</span><span class="n">y_dim</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">x_dim</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Perform the transpose</span>
        <span class="n">transposed_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">transposed_values</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">validmask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a mask of the valid values of the GeoTensor. The mask is a boolean array</span>
<span class="sd">        with the same shape as the GeoTensor values, where True indicates valid values and</span>
<span class="sd">        False indicates invalid values.</span>
<span class="sd">        The mask is created by comparing the values of the GeoTensor with the `self.fill_value_default`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self: GeoTensor with the valid boolean mask.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
                <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">invalidmask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a mask of the invalid values of the GeoTensor. The mask is a boolean array</span>
<span class="sd">        with the same shape as the GeoTensor values, where True indicates invalid values and</span>
<span class="sd">        False indicates valid values.</span>
<span class="sd">        The mask is created by comparing the values of the GeoTensor with the `self.fill_value_default`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Self: GeoTensor with the invalid boolean mask.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
                <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
                <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">fs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">load_tags</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">load_descriptions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">rio_env_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a GeoTensor from a file. It uses rasterio to read the data. This function</span>
<span class="sd">        loads all the data in memory. For a lazy loading reader use `georeader.rasterio_reader`.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): Path to the file.</span>
<span class="sd">            fs (Optional[Any], optional): fsspec.Filesystem object. Defaults to None.</span>
<span class="sd">            load_descriptions (bool, optional): If True, load the description of the image. Defaults to False.</span>
<span class="sd">            load_tags (bool, optional): If True, load the tags of the image. Defaults to False.</span>
<span class="sd">            rio_env_options (Optional[Dict[str, str]], optional): Rasterio environment options. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor: GeoTensor object with the loaded data.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">load_descriptions</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<span class="w">                    </span><span class="sd">&quot;&quot;&quot;Description loading not supported with `fsspec`. This is because</span>
<span class="sd">            the `descriptions` attribute cannote be loaded from a byte stream. This is a limitation of `rasterio`.</span>
<span class="sd">            The issue is related to how `rasterio.io.MemoryFile` handles band descriptions </span>
<span class="sd">            compared to direct file access. This is a known limitation when working </span>
<span class="sd">            with in-memory file representations in GDAL (which `rasterio` uses under </span>
<span class="sd">            the hood). If you need to load descriptions, you can use `georeader.rasterio_reader`</span>
<span class="sd">            class.&quot;&quot;&quot;</span>
                <span class="p">)</span>

            <span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_bytes</span><span class="p">(</span>
                    <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">load_tags</span><span class="o">=</span><span class="n">load_tags</span><span class="p">,</span> <span class="n">rio_env_options</span><span class="o">=</span><span class="n">rio_env_options</span>
                <span class="p">)</span>

        <span class="n">tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">descriptions</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">rio_env_options</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">RIO_ENV_OPTIONS_DEFAULT</span> <span class="k">if</span> <span class="n">rio_env_options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rio_env_options</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="o">**</span><span class="n">get_rio_options_path</span><span class="p">(</span><span class="n">rio_env_options</span><span class="p">,</span> <span class="n">path</span><span class="p">)):</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
                <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
                <span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>
                <span class="k">if</span> <span class="n">load_tags</span><span class="p">:</span>
                    <span class="n">tags</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">tags</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">load_descriptions</span><span class="p">:</span>
                    <span class="n">descriptions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">descriptions</span><span class="p">)</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>

        <span class="k">if</span> <span class="n">descriptions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">descriptions</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">load_bytes</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">bytes_read</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">,</span> <span class="nb">memoryview</span><span class="p">],</span>
        <span class="n">load_tags</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">rio_env_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a GeoTensor from a byte stream. It uses rasterio to read the data.</span>


<span class="sd">        Args:</span>
<span class="sd">            bytes_read (Union[bytes, bytearray, memoryview]): Byte stream to read.</span>
<span class="sd">            load_tags (bool, optional): if True, load the tags of the image. Defaults to False.</span>
<span class="sd">            rio_env_options (Optional[Dict[str, str]], optional): Rasterio environment options. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            __class__: GeoTensor object with the loaded data.</span>

<span class="sd">        Note:</span>
<span class="sd">            The `descriptions` attribute cannote be loaded from a byte stream. This is a limitation of `rasterio`.</span>
<span class="sd">            The issue is related to how `rasterio.io.MemoryFile` handles band descriptions</span>
<span class="sd">            compared to direct file access. This is a known limitation when working</span>
<span class="sd">            with in-memory file representations in GDAL (which `rasterio` uses under</span>
<span class="sd">            the hood). If you need to load descriptions, you should use `georeader.rasterio_reader`</span>
<span class="sd">            class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">rasterio.io</span>

        <span class="n">tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">rio_env_options</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">RIO_ENV_OPTIONS_DEFAULT</span> <span class="k">if</span> <span class="n">rio_env_options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rio_env_options</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="o">**</span><span class="n">rio_env_options</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">MemoryFile</span><span class="p">(</span><span class="n">bytes_read</span><span class="p">)</span> <span class="k">as</span> <span class="n">mem</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">mem</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                    <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
                    <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
                    <span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>
                    <span class="k">if</span> <span class="n">load_tags</span><span class="p">:</span>
                        <span class="n">tags</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">tags</span><span class="p">()</span>

        <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">write_from_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes array to GeoTensor values object at the given window position. If window surpasses the bounds of this</span>
<span class="sd">        object it crops the data to fit the object.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Tensor to write. Expected: spatial dimensions `window.width`, `window.height`. Rest: same as `self`</span>
<span class="sd">            window: Window object that specifies the spatial location to write the data</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; data = np.random.rand(3, 50, 50)</span>
<span class="sd">            &gt;&gt;&gt; window = rasterio.windows.Window(col_off=7, row_off=9, width=50, height=50)</span>
<span class="sd">            &gt;&gt;&gt; gt.write_from_window(data, window)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">window_data</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
            <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">window_data</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="p">(</span>
            <span class="n">window</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
            <span class="n">window</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;window </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2"> has different shape than data </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Dimension of data in non-spatial channels found </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> expected: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">slice_dict</span><span class="p">,</span> <span class="n">pad_width</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">get_slice_pad</span><span class="p">(</span><span class="n">window_data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
        <span class="n">slice_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
        <span class="c1"># need_pad = any(p != 0 for p in pad_width[&quot;x&quot;] + pad_width[&quot;y&quot;])</span>

        <span class="n">slice_data_spatial_x</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span>
            <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">slice_data_spatial_y</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span>
            <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">slice_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">slice_data_spatial_x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">slice_data_spatial_y</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slice_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">slice_data</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">read_from_window</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">,</span> <span class="n">boundless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns a new GeoTensor object with the spatial dimensions sliced</span>

<span class="sd">        Args:</span>
<span class="sd">            window: window to slice the current GeoTensor</span>
<span class="sd">            boundless: read from window in boundless mode (i.e. if the window is larger or negative it will pad</span>
<span class="sd">                the GeoTensor with `self.fill_value_default`)</span>

<span class="sd">        Raises:</span>
<span class="sd">            rasterio.windows.WindowError: if `window` does not intersect the data</span>

<span class="sd">        Returns:</span>
<span class="sd">            GeoTensor object with the spatial dimensions sliced</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">window_data</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
            <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">boundless</span><span class="p">:</span>
            <span class="n">slice_dict</span><span class="p">,</span> <span class="n">pad_width</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">get_slice_pad</span><span class="p">(</span><span class="n">window_data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
            <span class="n">need_pad</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
            <span class="n">X_sliced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">need_pad</span><span class="p">:</span>
                <span class="n">X_sliced</span> <span class="o">=</span> <span class="n">X_sliced</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
                    <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span>
                    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span>
                    <span class="n">constant_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">X_sliced</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">window_read</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">window_data</span><span class="p">)</span>
            <span class="n">slice_y</span><span class="p">,</span> <span class="n">slice_x</span> <span class="o">=</span> <span class="n">window_read</span><span class="o">.</span><span class="n">toslices</span><span class="p">()</span>
            <span class="n">slice_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">slice_x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">slice_y</span><span class="p">}</span>
            <span class="n">slices_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
            <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
                <span class="n">window_read</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slices_</span><span class="p">],</span>
                <span class="n">transform_current</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">geotensors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stacks a list of geotensors, assert that all of them has same shape, transform and crs.</span>

<span class="sd">        Args:</span>
<span class="sd">            geotensors: list of geotensors to concat. All with same shape, transform and crs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            geotensor with extra dim at the front: (len(geotensors),) + shape</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt1 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt2 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt3 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt = stack([gt1, gt2, gt3])</span>
<span class="sd">            &gt;&gt;&gt; assert gt.shape == (3, 3, 100, 100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Empty list provided can&#39;t concat&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">gt</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">gt</span>

        <span class="n">first_geotensor</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">array_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">),)</span> <span class="o">+</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">dtype</span>
        <span class="p">)</span>
        <span class="n">array_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">values</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geotensors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">assert</span> <span class="n">geo</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">first_geotensor</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different size in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">geo</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different shape in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">geo</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span>
            <span class="p">),</span> <span class="s2">&quot;Different fill_value_default in concat&quot;</span>
            <span class="n">array_out</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">values</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">array_out</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">geotensors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Concatenates a list of geotensors along a given axis, assert that all of them has same shape, transform and crs.</span>

<span class="sd">        Args:</span>
<span class="sd">            geotensors: list of geotensors to concat. All with same shape, transform and crs.</span>
<span class="sd">            axis: axis to concatenate. Must be less than the number of dimensions of the geotensors minus 2.</span>
<span class="sd">                default is 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            geotensor with extra dim at the front: (len(geotensors),) + shape</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; gt1 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt2 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt3 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">            &gt;&gt;&gt; gt = concatenate([gt1, gt2, gt3], axis=0)</span>
<span class="sd">            &gt;&gt;&gt; assert gt.shape == (9, 100, 100)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Empty list provided can&#39;t concat&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">first_geotensor</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Assert the axis is NOT an spatial axis</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">axis</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t concatenate along spatial axis&quot;</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geotensors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">assert</span> <span class="n">geo</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">first_geotensor</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different extent in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">geo</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span>
            <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different shape in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">geo</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span>
            <span class="p">),</span> <span class="s2">&quot;Different fill_value_default in concat&quot;</span>

        <span class="n">array_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">gt</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">geotensors</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">array_out</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="georeader.geotensor.GeoTensor.values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">values</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#georeader.geotensor.GeoTensor.values" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Return a view of the array (memory shared with original)</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__add__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__add__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Add two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if other is not a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the addition.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (GeoTensor): GeoTensor to add.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match.</span>
<span class="sd">        TypeError: if other is not a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the addition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for addition. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">+</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__and__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__and__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__and__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Perform bitwise AND operation between two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor or array-like to AND with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match when other is a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the bitwise AND operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform bitwise AND operation between two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): GeoTensor or array-like to AND with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match when other is a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the bitwise AND operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for bitwise AND. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&amp;</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__array__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__array__</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__array__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert the GeoTensor to a standard NumPy array.</p>
<p>This method is called by np.asarray() and most NumPy functions to get
the underlying NumPy array representation of this object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.dtype">dtype</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired data type for the returned array.
                       If None, the array's current dtype is preserved.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: A NumPy array view of this GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__array__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the GeoTensor to a standard NumPy array.</span>

<span class="sd">    This method is called by np.asarray() and most NumPy functions to get</span>
<span class="sd">    the underlying NumPy array representation of this object.</span>

<span class="sd">    Args:</span>
<span class="sd">        dtype (Optional[np.dtype]): The desired data type for the returned array.</span>
<span class="sd">                                   If None, the array&#39;s current dtype is preserved.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: A NumPy array view of this GeoTensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__array_finalize__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__array_finalize__</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__array_finalize__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize attributes when a new GeoTensor is created from an existing array.</p>
<p>This method is called whenever a new array object is created from an existing array
(e.g., through slicing, view casting, or copy operations).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The array object from which the new array is created.
                       Can be None if the array is being created from scratch.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__array_finalize__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Self</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize attributes when a new GeoTensor is created from an existing array.</span>

<span class="sd">    This method is called whenever a new array object is created from an existing array</span>
<span class="sd">    (e.g., through slicing, view casting, or copy operations).</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (Optional[np.ndarray]): The array object from which the new array is created.</span>
<span class="sd">                                   Can be None if the array is being created from scratch.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;transform&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;crs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;fill_value_default&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;fill_value_default&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;attrs&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__array_ufunc__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__array_ufunc__</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__array_ufunc__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Handle NumPy universal functions applied to this GeoTensor.</p>
<p>This method is called when a NumPy universal function (ufunc) is applied to the GeoTensor.
It converts GeoTensor inputs to NumPy arrays, applies the ufunc, and converts array results
back to GeoTensor objects with the same geospatial metadata.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ufunc</code>
            </td>
            <td>
                  <code><span title="numpy.ufunc">ufunc</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The NumPy universal function being applied</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The method of the ufunc ('<strong>call</strong>', 'reduce', etc.)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*inputs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input arrays to the ufunc</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to the ufunc</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[GeoTensor, NDArray]: If the result is an array, returns a new GeoTensor with the same
                  geospatial attributes. Otherwise, returns the original result.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">__array_ufunc__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle NumPy universal functions applied to this GeoTensor.</span>

<span class="sd">    This method is called when a NumPy universal function (ufunc) is applied to the GeoTensor.</span>
<span class="sd">    It converts GeoTensor inputs to NumPy arrays, applies the ufunc, and converts array results</span>
<span class="sd">    back to GeoTensor objects with the same geospatial metadata.</span>

<span class="sd">    Args:</span>
<span class="sd">        ufunc (np.ufunc): The NumPy universal function being applied</span>
<span class="sd">        method (str): The method of the ufunc (&#39;__call__&#39;, &#39;reduce&#39;, etc.)</span>
<span class="sd">        *inputs: The input arrays to the ufunc</span>
<span class="sd">        **kwargs: Additional keyword arguments to the ufunc</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[GeoTensor, NDArray]: If the result is an array, returns a new GeoTensor with the same</span>
<span class="sd">                              geospatial attributes. Otherwise, returns the original result.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Normal processing for most operations</span>
    <span class="n">inputs_arr</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inputs</span>
    <span class="p">)</span>
    <span class="c1"># Handle &#39;out&#39; argument if present</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;out&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">out_arrays</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
        <span class="c1"># Convert GeoTensor outputs to regular arrays</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">out_arrays</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">o</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">out</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out_arrays</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">),)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="n">out</span><span class="p">,)</span>
            <span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;out&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_arrays</span>

    <span class="c1"># Delegate to numpy&#39;s implementation</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__array_ufunc__</span><span class="p">(</span><span class="n">ufunc</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs_arr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">cast_to_geotensor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_preserved_spatial</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># Propagate metadata to output arrays</span>
    <span class="k">if</span> <span class="n">out_arrays</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">o_orig</span><span class="p">,</span> <span class="n">o_new</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="n">out</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">out</span><span class="p">],</span> <span class="n">out_arrays</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">cast_to_geotensor</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_orig</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">)</span>
                <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o_new</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">o_new</span> <span class="o">=</span> <span class="n">o_orig</span><span class="o">.</span><span class="n">array_as_geotensor</span><span class="p">(</span><span class="n">o_new</span><span class="p">)</span>

    <span class="c1"># Normal ufunc processing for other cases</span>
    <span class="k">if</span> <span class="n">cast_to_geotensor</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_as_geotensor</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__eq__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise equality comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating equality.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise equality comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating equality.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__ge__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__ge__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise greater than or equal comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating greater than or equal relationship.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise greater than or equal comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating greater than or equal relationship.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;=</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__getitem__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Get the values of the GeoTensor using the given key.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Key to index the GeoTensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the selected values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the values of the GeoTensor using the given key.</span>

<span class="sd">    Args:</span>
<span class="sd">        key: Key to index the GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the selected values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>

    <span class="n">sel_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Adding axis is not permitted to GeoTensors. Use `expand_dims`&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">type</span><span class="p">(</span><span class="o">...</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Using elipsis is not permitted with GeoTensors. Use `values` attribute&quot;</span>
                <span class="p">)</span>
            <span class="n">sel_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sel_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">sel_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__gt__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__gt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__gt__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise greater than comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating greater than relationship.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise greater than comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating greater than relationship.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__le__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__le__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise less than or equal comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating less than or equal relationship.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise less than or equal comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating less than or equal relationship.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;=</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__lt__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__lt__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise less than comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating less than relationship.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise less than comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating less than relationship.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">&lt;</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__mul__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__mul__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Multiply two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if other is not a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the multiplication.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multiply two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (GeoTensor): GeoTensor to add.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match.</span>
<span class="sd">        TypeError: if other is not a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the multiplication.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for multiplication. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__ne__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__ne__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Element-wise inequality comparison between GeoTensors or with a scalar/array.
The georeferencing must match if comparing with another GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to compare with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If comparing with a GeoTensor and the georeferencing doesn't match.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with boolean values indicating inequality.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Element-wise inequality comparison between GeoTensors or with a scalar/array.</span>
<span class="sd">    The georeferencing must match if comparing with another GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): Value to compare with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If comparing with a GeoTensor and the georeferencing doesn&#39;t match.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with boolean values indicating inequality.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for comparison. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__new__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__new__</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__new__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>This class is a wrapper around a numpy or torch tensor with geospatial information.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>values</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>numpy or torch tensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform</code>
            </td>
            <td>
                  <code><span title="rasterio.Affine">Affine</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>affine geospatial transform</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>crs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>coordinate reference system</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_value_default</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[int, float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value to fill when
reading out of bounds. Could be None. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>attrs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with the attributes of the GeoTensor
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>when the shape of the tensor is not 2d, 3d or 4d.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">values</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span>
    <span class="n">transform</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="p">,</span>
    <span class="n">crs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="n">fill_value_default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">attrs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is a wrapper around a numpy or torch tensor with geospatial information.</span>

<span class="sd">    Args:</span>
<span class="sd">        values (NDArray): numpy or torch tensor</span>
<span class="sd">        transform (rasterio.Affine): affine geospatial transform</span>
<span class="sd">        crs (Any): coordinate reference system</span>
<span class="sd">        fill_value_default (Optional[Union[int, float]], optional): Value to fill when</span>
<span class="sd">            reading out of bounds. Could be None. Defaults to 0.</span>
<span class="sd">        attrs (Optional[Dict[str, Any]], optional): dictionary with the attributes of the GeoTensor</span>
<span class="sd">            Defaults to None.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: when the shape of the tensor is not 2d, 3d or 4d.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

    <span class="n">obj</span><span class="o">.</span><span class="n">transform</span> <span class="o">=</span> <span class="n">transform</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">crs</span> <span class="o">=</span> <span class="n">crs</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">fill_value_default</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected 2d-4d array found </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">obj</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span> <span class="k">if</span> <span class="n">attrs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>

    <span class="k">return</span> <span class="n">obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__or__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__or__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__or__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Perform bitwise OR operation between two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numbers.Number">Number</span>, <span title="numpy.typing.NDArray">NDArray</span>, <a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor or array-like to OR with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match when other is a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the bitwise OR operation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform bitwise OR operation between two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (Union[numbers.Number, NDArray, GeoTensor]): GeoTensor or array-like to OR with.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match when other is a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the bitwise OR operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for bitwise OR. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">|</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__sub__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__sub__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__sub__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Substract two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if other is not a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the substraction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Substract two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (GeoTensor): GeoTensor to add.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match.</span>
<span class="sd">        TypeError: if other is not a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the substraction.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for substraction. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.__truediv__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.__truediv__" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Divide two GeoTensors. The georeferencing must match.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the georeferencing does not match.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TypeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if other is not a GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the result of the division.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Divide two GeoTensors. The georeferencing must match.</span>

<span class="sd">    Args:</span>
<span class="sd">        other (GeoTensor): GeoTensor to add.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: if the georeferencing does not match.</span>
<span class="sd">        TypeError: if other is not a GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the result of the division.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">GeoTensor</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">values</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;GeoTensor georref must match for division. &quot;</span>
                <span class="s2">&quot;Use `read.read_reproject_like(other, self)` to &quot;</span>
                <span class="s2">&quot;to reproject `other` to `self` georreferencing.&quot;</span>
            <span class="p">)</span>

    <span class="n">result_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">/</span> <span class="n">other</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">result_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.array_as_geotensor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">array_as_geotensor</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.array_as_geotensor" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert a NumPy array result back to a GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>result</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="typing_extensions.Self">Self</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Any NumPy array or GeoTensor.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fill_value_default</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="numbers.Number">Number</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fill value for the returned GeoTensor.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Self</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new GeoTensor with the same geospatial attributes as the original.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">array_as_geotensor</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">result</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Self</span><span class="p">],</span>
    <span class="n">fill_value_default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a NumPy array result back to a GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        result (Union[np.ndarray, Self]): Any NumPy array or GeoTensor.</span>
<span class="sd">        fill_value_default: fill value for the returned GeoTensor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Self: A new GeoTensor with the same geospatial attributes as the original.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Propagate metadata for array results</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Operation altered spatial dimensions!&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fill_value_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">result</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.clip" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clip</span><span class="p">(</span><span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.clip" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Clip the GeoTensor values between the GeoTensor min and max values.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>a_min</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>a_max</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the clipped values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">clip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a_min</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">],</span> <span class="n">a_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clip the GeoTensor values between the GeoTensor min and max values.</span>

<span class="sd">    Args:</span>
<span class="sd">        a_min (float): Minimum value.</span>
<span class="sd">        a_max (float): Maximum value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the clipped values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">clipped_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">a_min</span><span class="p">,</span> <span class="n">a_max</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">clipped_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.concatenate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">concatenate</span><span class="p">(</span><span class="n">geotensors</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#georeader.geotensor.GeoTensor.concatenate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Concatenates a list of geotensors along a given axis, assert that all of them has same shape, transform and crs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>geotensors</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing_extensions.Self">Self</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of geotensors to concat. All with same shape, transform and crs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>axis</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>axis to concatenate. Must be less than the number of dimensions of the geotensors minus 2.
default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>geotensor with extra dim at the front: (len(geotensors),) + shape</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt1</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt2</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt3</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="n">gt1</span><span class="p">,</span> <span class="n">gt2</span><span class="p">,</span> <span class="n">gt3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gt</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">geotensors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">],</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Concatenates a list of geotensors along a given axis, assert that all of them has same shape, transform and crs.</span>

<span class="sd">    Args:</span>
<span class="sd">        geotensors: list of geotensors to concat. All with same shape, transform and crs.</span>
<span class="sd">        axis: axis to concatenate. Must be less than the number of dimensions of the geotensors minus 2.</span>
<span class="sd">            default is 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geotensor with extra dim at the front: (len(geotensors),) + shape</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt1 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt2 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt3 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt = concatenate([gt1, gt2, gt3], axis=0)</span>
<span class="sd">        &gt;&gt;&gt; assert gt.shape == (9, 100, 100)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Empty list provided can&#39;t concat&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">first_geotensor</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Assert the axis is NOT an spatial axis</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">axis</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t concatenate along spatial axis&quot;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geotensors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">assert</span> <span class="n">geo</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">first_geotensor</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different extent in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">geo</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different shape in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">geo</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span>
        <span class="p">),</span> <span class="s2">&quot;Different fill_value_default in concat&quot;</span>

    <span class="n">array_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">gt</span><span class="o">.</span><span class="n">values</span> <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">geotensors</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">array_out</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.expand_dims" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expand_dims</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.expand_dims" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Expand the dimensions of the GeoTensor values while preserving the spatial dimensions.</p>
<p>This method ensures that no dimensions are added after or in between the spatial dimensions
(which are always the last two dimensions).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axis</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[int, tuple]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Position or positions where new axes should be inserted.
Must be less than the number of dimensions minus 2 (to preserve spatial dims).
Positions are counted from the first dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the expanded values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If trying to add dimensions at or after the spatial dimensions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add a new dimension at axis 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_expanded</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gt_expanded</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expand the dimensions of the GeoTensor values while preserving the spatial dimensions.</span>

<span class="sd">    This method ensures that no dimensions are added after or in between the spatial dimensions</span>
<span class="sd">    (which are always the last two dimensions).</span>

<span class="sd">    Args:</span>
<span class="sd">        axis (Union[int, tuple]): Position or positions where new axes should be inserted.</span>
<span class="sd">            Must be less than the number of dimensions minus 2 (to preserve spatial dims).</span>
<span class="sd">            Positions are counted from the first dimension.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the expanded values.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If trying to add dimensions at or after the spatial dimensions.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; # Add a new dimension at axis 0</span>
<span class="sd">        &gt;&gt;&gt; gt_expanded = gt.expand_dims(0)</span>
<span class="sd">        &gt;&gt;&gt; assert gt_expanded.shape == (1, 3, 100, 100)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="c1"># Check if axis is valid (not interfering with spatial dimensions)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">&gt;=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ndim</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Cannot add dimension at or after spatial dimensions. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Axis must be &lt; </span><span class="si">{</span><span class="n">ndim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> or &gt;= </span><span class="si">{</span><span class="o">-</span><span class="n">ndim</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">axis</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="c1"># Convert negative axis to positive</span>
        <span class="k">if</span> <span class="n">axis</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">+</span> <span class="n">axis</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># tuple of axes</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ax</span> <span class="o">&gt;=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">ax</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ndim</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Cannot add dimension at or after spatial dimensions. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;All axes must be &lt; </span><span class="si">{</span><span class="n">ndim</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2"> or &gt;= </span><span class="si">{</span><span class="o">-</span><span class="n">ndim</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">ax</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>

    <span class="c1"># Use numpy expand_dims to add the new dimensions</span>
    <span class="n">expanded_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">expanded_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.footprint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">footprint</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.footprint" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns the footprint of the GeoTensor as a Polygon.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinate reference system. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Polygon</code></td>            <td>
                  <code><span title="shapely.geometry.Polygon">Polygon</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>footprint of the GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">footprint</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="s2">&quot;EPSG:4326&quot;</span><span class="p">)</span> <span class="c1"># returns a Polygon in WGS84</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">footprint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Polygon</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the footprint of the GeoTensor as a Polygon.</span>

<span class="sd">    Args:</span>
<span class="sd">        crs (Optional[str], optional): Coordinate reference system. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Polygon: footprint of the GeoTensor.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt.footprint(crs=&quot;EPSG:4326&quot;) # returns a Polygon in WGS84</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pol</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">window_polygon</span><span class="p">(</span>
        <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
            <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">),</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">compare_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">pol</span>

    <span class="k">return</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">polygon_to_crs</span><span class="p">(</span><span class="n">pol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.invalidmask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">invalidmask</span><span class="p">()</span></code>

<a href="#georeader.geotensor.GeoTensor.invalidmask" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a mask of the invalid values of the GeoTensor. The mask is a boolean array
with the same shape as the GeoTensor values, where True indicates invalid values and
False indicates valid values.
The mask is created by comparing the values of the GeoTensor with the <code>self.fill_value_default</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Self</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the invalid boolean mask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">invalidmask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a mask of the invalid values of the GeoTensor. The mask is a boolean array</span>
<span class="sd">    with the same shape as the GeoTensor values, where True indicates invalid values and</span>
<span class="sd">    False indicates valid values.</span>
<span class="sd">    The mask is created by comparing the values of the GeoTensor with the `self.fill_value_default`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Self: GeoTensor with the invalid boolean mask.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.isel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">isel</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.isel" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Slicing with dict. Spatial dimensions can only be sliced with slices.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>sel</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[str, <span title="typing.Union">Union</span>[slice, list, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dict with slice selection; i.e. <code>{"x": slice(10, 20), "y": slice(20, 340)}</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the sliced values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">340</span><span class="p">)})</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sel</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">slice</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="nb">int</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Slicing with dict. Spatial dimensions can only be sliced with slices.</span>

<span class="sd">    Args:</span>
<span class="sd">        sel: Dict with slice selection; i.e. `{&quot;x&quot;: slice(10, 20), &quot;y&quot;: slice(20, 340)}`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the sliced values.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt.isel({&quot;x&quot;: slice(10, 20), &quot;y&quot;: slice(20, 340)})</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Axis </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">slice_tuple</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>

    <span class="c1"># Compùte the window to shift the transform</span>
    <span class="n">slices_window</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">slice</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Only slice selection supported for x, y dims, found </span><span class="si">{</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sel</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
            <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

    <span class="n">window_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">from_slices</span><span class="p">(</span>
        <span class="o">*</span><span class="n">slices_window</span><span class="p">,</span> <span class="n">boundless</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span>
    <span class="p">)</span>

    <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">window_current</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
    <span class="p">)</span>

    <span class="c1"># Scale the spatial transform if the step of the slices &gt; 1</span>
    <span class="n">step_rows</span> <span class="o">=</span> <span class="n">slices_window</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">step</span>
    <span class="n">step_cols</span> <span class="o">=</span> <span class="n">slices_window</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">step</span>
    <span class="k">if</span> <span class="n">step_rows</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">step_rows</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">step_cols</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">step_cols</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">step_rows</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">step_cols</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">transform_current</span> <span class="o">=</span> <span class="n">transform_current</span> <span class="o">*</span> <span class="n">Affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">step_cols</span><span class="p">,</span> <span class="n">step_rows</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slice_tuple</span><span class="p">],</span>
        <span class="n">transform_current</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.load_bytes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_bytes</span><span class="p">(</span><span class="n">bytes_read</span><span class="p">,</span> <span class="n">load_tags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rio_env_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#georeader.geotensor.GeoTensor.load_bytes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load a GeoTensor from a byte stream. It uses rasterio to read the data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bytes_read</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[bytes, bytearray, memoryview]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Byte stream to read.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_tags</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if True, load the tags of the image. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rio_env_options</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rasterio environment options. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>__class__</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor object with the loaded data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The <code>descriptions</code> attribute cannote be loaded from a byte stream. This is a limitation of <code>rasterio</code>.
The issue is related to how <code>rasterio.io.MemoryFile</code> handles band descriptions
compared to direct file access. This is a known limitation when working
with in-memory file representations in GDAL (which <code>rasterio</code> uses under
the hood). If you need to load descriptions, you should use <code>georeader.rasterio_reader</code>
class.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_bytes</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">bytes_read</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">,</span> <span class="nb">memoryview</span><span class="p">],</span>
    <span class="n">load_tags</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">rio_env_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a GeoTensor from a byte stream. It uses rasterio to read the data.</span>


<span class="sd">    Args:</span>
<span class="sd">        bytes_read (Union[bytes, bytearray, memoryview]): Byte stream to read.</span>
<span class="sd">        load_tags (bool, optional): if True, load the tags of the image. Defaults to False.</span>
<span class="sd">        rio_env_options (Optional[Dict[str, str]], optional): Rasterio environment options. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        __class__: GeoTensor object with the loaded data.</span>

<span class="sd">    Note:</span>
<span class="sd">        The `descriptions` attribute cannote be loaded from a byte stream. This is a limitation of `rasterio`.</span>
<span class="sd">        The issue is related to how `rasterio.io.MemoryFile` handles band descriptions</span>
<span class="sd">        compared to direct file access. This is a known limitation when working</span>
<span class="sd">        with in-memory file representations in GDAL (which `rasterio` uses under</span>
<span class="sd">        the hood). If you need to load descriptions, you should use `georeader.rasterio_reader`</span>
<span class="sd">        class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">rasterio.io</span>

    <span class="n">tags</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rio_env_options</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">RIO_ENV_OPTIONS_DEFAULT</span> <span class="k">if</span> <span class="n">rio_env_options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rio_env_options</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="o">**</span><span class="n">rio_env_options</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">MemoryFile</span><span class="p">(</span><span class="n">bytes_read</span><span class="p">)</span> <span class="k">as</span> <span class="n">mem</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">mem</span><span class="o">.</span><span class="n">open</span><span class="p">()</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
                <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
                <span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>
                <span class="k">if</span> <span class="n">load_tags</span><span class="p">:</span>
                    <span class="n">tags</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">tags</span><span class="p">()</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.load_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">load_tags</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">load_descriptions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rio_env_options</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#georeader.geotensor.GeoTensor.load_file" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load a GeoTensor from a file. It uses rasterio to read the data. This function
loads all the data in memory. For a lazy loading reader use <code>georeader.rasterio_reader</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>fsspec.Filesystem object. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_descriptions</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, load the description of the image. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_tags</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, load the tags of the image. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rio_env_options</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Dict">Dict</span>[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rasterio environment options. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor object with the loaded data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">load_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">fs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">load_tags</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">load_descriptions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">rio_env_options</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load a GeoTensor from a file. It uses rasterio to read the data. This function</span>
<span class="sd">    loads all the data in memory. For a lazy loading reader use `georeader.rasterio_reader`.</span>

<span class="sd">    Args:</span>
<span class="sd">        path (str): Path to the file.</span>
<span class="sd">        fs (Optional[Any], optional): fsspec.Filesystem object. Defaults to None.</span>
<span class="sd">        load_descriptions (bool, optional): If True, load the description of the image. Defaults to False.</span>
<span class="sd">        load_tags (bool, optional): If True, load the tags of the image. Defaults to False.</span>
<span class="sd">        rio_env_options (Optional[Dict[str, str]], optional): Rasterio environment options. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor object with the loaded data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">fs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">load_descriptions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Description loading not supported with `fsspec`. This is because</span>
<span class="sd">        the `descriptions` attribute cannote be loaded from a byte stream. This is a limitation of `rasterio`.</span>
<span class="sd">        The issue is related to how `rasterio.io.MemoryFile` handles band descriptions </span>
<span class="sd">        compared to direct file access. This is a known limitation when working </span>
<span class="sd">        with in-memory file representations in GDAL (which `rasterio` uses under </span>
<span class="sd">        the hood). If you need to load descriptions, you can use `georeader.rasterio_reader`</span>
<span class="sd">        class.&quot;&quot;&quot;</span>
            <span class="p">)</span>

        <span class="k">with</span> <span class="n">fs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">load_bytes</span><span class="p">(</span>
                <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">load_tags</span><span class="o">=</span><span class="n">load_tags</span><span class="p">,</span> <span class="n">rio_env_options</span><span class="o">=</span><span class="n">rio_env_options</span>
            <span class="p">)</span>

    <span class="n">tags</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">descriptions</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">rio_env_options</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">RIO_ENV_OPTIONS_DEFAULT</span> <span class="k">if</span> <span class="n">rio_env_options</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rio_env_options</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Env</span><span class="p">(</span><span class="o">**</span><span class="n">get_rio_options_path</span><span class="p">(</span><span class="n">rio_env_options</span><span class="p">,</span> <span class="n">path</span><span class="p">)):</span>
        <span class="k">with</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">as</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">transform</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">transform</span>
            <span class="n">crs</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">crs</span>
            <span class="n">fill_value_default</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">nodata</span>
            <span class="k">if</span> <span class="n">load_tags</span><span class="p">:</span>
                <span class="n">tags</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">tags</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">load_descriptions</span><span class="p">:</span>
                <span class="n">descriptions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">descriptions</span><span class="p">)</span>

    <span class="n">attrs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">tags</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tags</span>

    <span class="k">if</span> <span class="n">descriptions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;descriptions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">descriptions</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">fill_value_default</span><span class="o">=</span><span class="n">fill_value_default</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.meshgrid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">meshgrid</span><span class="p">(</span><span class="n">dst_crs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.meshgrid" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a meshgrid of spatial dimensions of the GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dst_crs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output coordinate reference system. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>, <span title="numpy.typing.NDArray">NDArray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[NDArray, NDArray]: 2D arrays of xs and ys coordinates.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">meshgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst_crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a meshgrid of spatial dimensions of the GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        dst_crs (Optional[Any], optional): output coordinate reference system. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[NDArray, NDArray]: 2D arrays of xs and ys coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">georeader</span> <span class="kn">import</span> <span class="n">griddata</span>

    <span class="k">return</span> <span class="n">griddata</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">source_crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">dst_crs</span><span class="o">=</span><span class="n">dst_crs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.pad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pad</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.pad" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pad the GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pad_width</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>[str, <span title="typing.Tuple">Tuple</span>[int, int]], <span title="typing.List">List</span>[<span title="typing.Tuple">Tuple</span>[int, int]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with Tuple to pad for each dimension
<code>{"x": (pad_x_0, pad_x_1), "y": (pad_y_0, pad_y_1)}</code> or list of tuples
<code>[(pad_x_0, pad_x_1), (pad_y_0, pad_y_1)]</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pad mode (see np.pad or torch.nn.functional.pad). Defaults to "constant".</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>additional arguments for the pad function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>padded GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pad_width</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pad the GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        pad_width (Union[Dict[str, Tuple[int, int]], List[Tuple[int, int]]]):</span>
<span class="sd">            dictionary with Tuple to pad for each dimension</span>
<span class="sd">            `{&quot;x&quot;: (pad_x_0, pad_x_1), &quot;y&quot;: (pad_y_0, pad_y_1)}` or list of tuples</span>
<span class="sd">            `[(pad_x_0, pad_x_1), (pad_y_0, pad_y_1)]`.</span>
<span class="sd">        mode (str, optional): pad mode (see np.pad or torch.nn.functional.pad). Defaults to &quot;constant&quot;.</span>
<span class="sd">        kwargs: additional arguments for the pad function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: padded GeoTensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pad_width</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span><span class="si">}</span><span class="s2"> pad widths found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pad_width</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="n">pad_width_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">):</span>
            <span class="n">pad_width_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pad_width</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pad_width_dict</span> <span class="o">=</span> <span class="n">pad_width</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pad_array</span><span class="p">(</span><span class="n">pad_width_dict</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.pad_array" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pad_array</span><span class="p">(</span><span class="n">pad_width</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_values</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.pad_array" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pad the GeoTensor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pad_width</code>
            </td>
            <td>
                  <code>_type_</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dictionary with Tuple to pad for each dimension
<code>{"x": (pad_x_0, pad_x_1), "y": (pad_y_0, pad_y_1)}</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pad mode (see np.pad or torch.nn.functional.pad). Defaults to "constant".</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constant_values</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><em>description</em>. Defaults to <code>self.fill_value_default</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>padded GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">pad_array</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gt</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pad_array</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pad_width</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span>
    <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="n">constant_values</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Pad the GeoTensor.</span>

<span class="sd">    Args:</span>
<span class="sd">        pad_width (_type_, optional):  dictionary with Tuple to pad for each dimension</span>
<span class="sd">            `{&quot;x&quot;: (pad_x_0, pad_x_1), &quot;y&quot;: (pad_y_0, pad_y_1)}`.</span>
<span class="sd">        mode (str, optional): pad mode (see np.pad or torch.nn.functional.pad). Defaults to &quot;constant&quot;.</span>
<span class="sd">        constant_values (Any, optional): _description_. Defaults to `self.fill_value_default`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: padded GeoTensor.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt.pad_array({&quot;x&quot;: (10, 10), &quot;y&quot;: (10, 10)})</span>
<span class="sd">        &gt;&gt;&gt; assert gt.shape == (3, 120, 120)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">constant_values</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Mode constant either requires constant_values passed or fill_value_default not None in current GeoTensor&quot;</span>
            <span class="p">)</span>
        <span class="n">constant_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>

    <span class="n">pad_list_np</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">:</span>
            <span class="n">pad_list_np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pad_list_np</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

    <span class="n">kwargs_extra</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&quot;constant&quot;</span><span class="p">:</span>
        <span class="n">kwargs_extra</span><span class="p">[</span><span class="s2">&quot;constant_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">constant_values</span>
    <span class="n">values_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">pad_list_np</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_extra</span><span class="p">)</span>

    <span class="c1"># Compute the new transform</span>
    <span class="n">slices_window</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">]:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">:</span>
            <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">size</span> <span class="o">+</span> <span class="n">pad_width</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slices_window</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

    <span class="n">window_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="o">.</span><span class="n">from_slices</span><span class="p">(</span>
        <span class="o">*</span><span class="n">slices_window</span><span class="p">,</span> <span class="n">boundless</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
        <span class="n">window_current</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">values_new</span><span class="p">,</span>
        <span class="n">transform_current</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.read_from_window" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">read_from_window</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">boundless</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.read_from_window" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>returns a new GeoTensor object with the spatial dimensions sliced</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="rasterio.windows.Window">Window</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>window to slice the current GeoTensor</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>boundless</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>read from window in boundless mode (i.e. if the window is larger or negative it will pad
the GeoTensor with <code>self.fill_value_default</code>)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="rasterio.windows.WindowError">WindowError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if <code>window</code> does not intersect the data</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor object with the spatial dimensions sliced</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_from_window</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">,</span> <span class="n">boundless</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns a new GeoTensor object with the spatial dimensions sliced</span>

<span class="sd">    Args:</span>
<span class="sd">        window: window to slice the current GeoTensor</span>
<span class="sd">        boundless: read from window in boundless mode (i.e. if the window is larger or negative it will pad</span>
<span class="sd">            the GeoTensor with `self.fill_value_default`)</span>

<span class="sd">    Raises:</span>
<span class="sd">        rasterio.windows.WindowError: if `window` does not intersect the data</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor object with the spatial dimensions sliced</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">window_data</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
        <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">boundless</span><span class="p">:</span>
        <span class="n">slice_dict</span><span class="p">,</span> <span class="n">pad_width</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">get_slice_pad</span><span class="p">(</span><span class="n">window_data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
        <span class="n">need_pad</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">p</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span>
        <span class="n">X_sliced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">need_pad</span><span class="p">:</span>
            <span class="n">X_sliced</span> <span class="o">=</span> <span class="n">X_sliced</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span>
                <span class="n">pad_width</span><span class="o">=</span><span class="n">pad_width</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span>
                <span class="n">constant_values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">X_sliced</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">window_read</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">window_data</span><span class="p">)</span>
        <span class="n">slice_y</span><span class="p">,</span> <span class="n">slice_x</span> <span class="o">=</span> <span class="n">window_read</span><span class="o">.</span><span class="n">toslices</span><span class="p">()</span>
        <span class="n">slice_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">slice_x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">slice_y</span><span class="p">}</span>
        <span class="n">slices_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
        <span class="n">transform_current</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="n">window_read</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slices_</span><span class="p">],</span>
            <span class="n">transform_current</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.resize" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resize</span><span class="p">(</span><span class="n">output_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution_dst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">anti_aliasing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">,</span> <span class="n">mode_pad</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.resize" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Resize the geotensor to match a certain size output_shape. This function works with GeoTensors of 2D, 3D and 4D.
The geoinformation of the output tensor is changed accordingly.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_shape</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[int, int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output spatial shape if None resolution_dst must be provided. If not provided,
the output shape is computed from the resolution_dst rounding to the closest integer.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>resolution_dst</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[float, float]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>output resolution if None output_shape must be provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anti_aliasing</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to apply a Gaussian filter to smooth the image prior to downsampling</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>anti_aliasing_sigma</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[float, <span title="numpy.ndarray">ndarray</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>anti_aliasing_sigma : {float}, optional
Standard deviation for Gaussian filtering used when anti-aliasing.
By default, this value is chosen as (s - 1) / 2 where s is the
downsampling factor, where s &gt; 1</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interpolation</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Algorithm used for resizing: 'nearest' | 'bilinear' | 'bicubic'</p>
              </div>
            </td>
            <td>
                  <code>&#39;bilinear&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mode_pad</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mode pad for resize function</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>resized GeoTensor</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resized</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">resized</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">resized</span><span class="o">.</span><span class="n">res</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">gt</span><span class="o">.</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="o">*</span><span class="n">gt</span><span class="o">.</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">output_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resolution_dst</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">anti_aliasing</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">anti_aliasing_sigma</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">interpolation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
    <span class="n">mode_pad</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resize the geotensor to match a certain size output_shape. This function works with GeoTensors of 2D, 3D and 4D.</span>
<span class="sd">    The geoinformation of the output tensor is changed accordingly.</span>

<span class="sd">    Args:</span>
<span class="sd">        output_shape: output spatial shape if None resolution_dst must be provided. If not provided,</span>
<span class="sd">            the output shape is computed from the resolution_dst rounding to the closest integer.</span>
<span class="sd">        resolution_dst: output resolution if None output_shape must be provided.</span>
<span class="sd">        anti_aliasing: Whether to apply a Gaussian filter to smooth the image prior to downsampling</span>
<span class="sd">        anti_aliasing_sigma:  anti_aliasing_sigma : {float}, optional</span>
<span class="sd">            Standard deviation for Gaussian filtering used when anti-aliasing.</span>
<span class="sd">            By default, this value is chosen as (s - 1) / 2 where s is the</span>
<span class="sd">            downsampling factor, where s &gt; 1</span>
<span class="sd">        interpolation: Algorithm used for resizing: &#39;nearest&#39; | &#39;bilinear&#39; | &#39;bicubic&#39;</span>
<span class="sd">        mode_pad: mode pad for resize function</span>

<span class="sd">    Returns:</span>
<span class="sd">         resized GeoTensor</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; resized = gt.resize((50, 50))</span>
<span class="sd">        &gt;&gt;&gt; assert resized.shape == (3, 50, 50)</span>
<span class="sd">        &gt;&gt;&gt; assert resized.res == (2*gt.res[0], 2*gt.res[1])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">input_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">spatial_shape</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span>
    <span class="n">resolution_or</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">res</span>

    <span class="k">if</span> <span class="n">output_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">resolution_dst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Can&#39;t have output_shape and resolution_dst as None&quot;</span>
        <span class="n">output_shape</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="nb">round</span><span class="p">(</span><span class="n">spatial_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">spatial_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">resolution_dst</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Both output_shape and resolution_dst can&#39;t be provided&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="nb">len</span><span class="p">(</span><span class="n">output_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Expected output shape to be the spatial dimensions found: </span><span class="si">{</span><span class="n">output_shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">resolution_dst</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">spatial_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">spatial_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="c1"># Compute output transform</span>
    <span class="n">transform_scale</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">Affine</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span>
        <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">resolution_dst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">resolution_or</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">transform</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform</span> <span class="o">*</span> <span class="n">transform_scale</span>

    <span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">resize</span>

    <span class="c1"># https://scikit-image.org/docs/stable/api/skimage.transform.html#skimage.transform.resize</span>
    <span class="n">output_tensor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">input_shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">output_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="ow">not</span> <span class="n">anti_aliasing</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">anti_aliasing_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
            <span class="n">output_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span>
                <span class="n">output_shape</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
                <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
                <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
                <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma_iter</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">input_shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="p">(</span><span class="ow">not</span> <span class="n">anti_aliasing</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">anti_aliasing_sigma</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">anti_aliasing_sigma_iter</span> <span class="o">=</span> <span class="n">anti_aliasing_sigma</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">output_tensor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="n">output_shape</span><span class="p">,</span>
                <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
                <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
                <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
                <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
                <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma_iter</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output_tensor</span><span class="p">[</span><span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="n">resize</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">output_shape</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">ORDERS</span><span class="p">[</span><span class="n">interpolation</span><span class="p">],</span>
            <span class="n">anti_aliasing</span><span class="o">=</span><span class="n">anti_aliasing</span><span class="p">,</span>
            <span class="n">preserve_range</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">cval</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode_pad</span><span class="p">,</span>
            <span class="n">anti_aliasing_sigma</span><span class="o">=</span><span class="n">anti_aliasing_sigma</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">output_tensor</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.same_extent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">same_extent</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.same_extent" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check if two GeoTensors have the same georeferencing (crs, transform and spatial dimensions).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="georeader.geotensor.GeoTensor" href="#georeader.geotensor.GeoTensor">GeoTensor</a> | GeoData</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor to compare with. Other GeoData object can be passed (it requires crs, transform and shape attributes)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>precision</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>precision to compare the transform. Defaults to 1e-3.</p>
              </div>
            </td>
            <td>
                  <code>0.001</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if both GeoTensors have the same georeferencing.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">same_extent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Self</span><span class="p">,</span> <span class="n">precision</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if two GeoTensors have the same georeferencing (crs, transform and spatial dimensions).</span>

<span class="sd">    Args:</span>
<span class="sd">        other (GeoTensor | GeoData): GeoTensor to compare with. Other GeoData object can be passed (it requires crs, transform and shape attributes)</span>
<span class="sd">        precision (float, optional): precision to compare the transform. Defaults to 1e-3.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if both GeoTensors have the same georeferencing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">almost_equals</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">)</span>
        <span class="ow">and</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">compare_crs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
        <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.squeeze" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">squeeze</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.squeeze" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Remove single-dimensional entries from the shape of the GeoTensor values.
It does not squeeze the spatial dimensions (last two dimensions).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the squeezed values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove single-dimensional entries from the shape of the GeoTensor values.</span>
<span class="sd">    It does not squeeze the spatial dimensions (last two dimensions).</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: GeoTensor with the squeezed values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">axis</span> <span class="o">=</span> <span class="p">(</span><span class="n">axis</span><span class="p">,)</span>
        <span class="c1"># Check if spatial dimesions will be squeezed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot squeeze spatial dimensions. &quot;</span>
                    <span class="s2">&quot;Use `squeeze(axis=0)` to squeeze the first dimension.&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">a</span> <span class="ow">in</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axis</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Cannot squeeze spatial dimensions. &quot;</span>
                    <span class="s2">&quot;Use `squeeze(axis=0)` to squeeze the first dimension.&quot;</span>
                <span class="p">)</span>

    <span class="c1"># squeeze all but last two dimensions</span>
    <span class="n">squeezed_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">squeezed_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.stack" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stack</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#georeader.geotensor.GeoTensor.stack" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Stacks a list of geotensors, assert that all of them has same shape, transform and crs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>geotensors</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="typing_extensions.Self">Self</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of geotensors to concat. All with same shape, transform and crs.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>geotensor with extra dim at the front: (len(geotensors),) + shape</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt1</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt2</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt3</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">stack</span><span class="p">([</span><span class="n">gt1</span><span class="p">,</span> <span class="n">gt2</span><span class="p">,</span> <span class="n">gt3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">gt</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">stack</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">geotensors</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Self</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stacks a list of geotensors, assert that all of them has same shape, transform and crs.</span>

<span class="sd">    Args:</span>
<span class="sd">        geotensors: list of geotensors to concat. All with same shape, transform and crs.</span>

<span class="sd">    Returns:</span>
<span class="sd">        geotensor with extra dim at the front: (len(geotensors),) + shape</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt1 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt2 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt3 = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; gt = stack([gt1, gt2, gt3])</span>
<span class="sd">        &gt;&gt;&gt; assert gt.shape == (3, 3, 100, 100)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Empty list provided can&#39;t concat&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">gt</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">gt</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">gt</span>

    <span class="n">first_geotensor</span> <span class="o">=</span> <span class="n">geotensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">array_out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
        <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geotensors</span><span class="p">),)</span> <span class="o">+</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">dtype</span>
    <span class="p">)</span>
    <span class="n">array_out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">values</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">geo</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">geotensors</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
        <span class="k">assert</span> <span class="n">geo</span><span class="o">.</span><span class="n">same_extent</span><span class="p">(</span><span class="n">first_geotensor</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different size in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">geo</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">shape</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Different shape in concat </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">geo</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="o">==</span> <span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span>
        <span class="p">),</span> <span class="s2">&quot;Different fill_value_default in concat&quot;</span>
        <span class="n">array_out</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo</span><span class="o">.</span><span class="n">values</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">array_out</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="n">first_geotensor</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.transpose" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">transpose</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.transpose" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Permute the dimensions of the GeoTensor while keeping the spatial dimensions at the end.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>axes</code>
            </td>
            <td>
                  <code>tuple</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If specified, it must be a tuple or list of axes. The last two
values must be the original spatial dimensions indices (ndim-2, ndim-1).
If None, the non-spatial dimensions are reversed while spatial dimensions remain at the end.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>GeoTensor</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A view of the array with dimensions transposed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the spatial dimensions are moved from their last positions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shape is (3, 4, 100, 200)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_t</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Shape is now (4, 3, 100, 200)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You can also specify axes explicitly:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt_t</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># Valid: spatial dims remain at end</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># But this would raise an error:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># gt.transpose((0, 2, 1, 3))  # Invalid: spatial dims must stay at end</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Permute the dimensions of the GeoTensor while keeping the spatial dimensions at the end.</span>

<span class="sd">    Args:</span>
<span class="sd">        axes (tuple, optional): If specified, it must be a tuple or list of axes. The last two</span>
<span class="sd">            values must be the original spatial dimensions indices (ndim-2, ndim-1).</span>
<span class="sd">            If None, the non-spatial dimensions are reversed while spatial dimensions remain at the end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        GeoTensor: A view of the array with dimensions transposed.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the spatial dimensions are moved from their last positions.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 4, 100, 200), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; # Shape is (3, 4, 100, 200)</span>
<span class="sd">        &gt;&gt;&gt; gt_t = gt.transpose()</span>
<span class="sd">        &gt;&gt;&gt; # Shape is now (4, 3, 100, 200)</span>
<span class="sd">        &gt;&gt;&gt;</span>
<span class="sd">        &gt;&gt;&gt; # You can also specify axes explicitly:</span>
<span class="sd">        &gt;&gt;&gt; gt_t = gt.transpose((1, 0, 2, 3))  # Valid: spatial dims remain at end</span>
<span class="sd">        &gt;&gt;&gt; # But this would raise an error:</span>
<span class="sd">        &gt;&gt;&gt; # gt.transpose((0, 2, 1, 3))  # Invalid: spatial dims must stay at end</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ndim</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Nothing meaningful to transpose for arrays with only spatial dimensions</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Original spatial dimensions indices</span>
    <span class="n">y_dim</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span>
    <span class="n">x_dim</span> <span class="o">=</span> <span class="n">ndim</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Reverse all dimensions except the spatial ones which stay at the end</span>
        <span class="n">non_spatial_axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ndim</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">non_spatial_axes</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">non_spatial_axes</span> <span class="o">+</span> <span class="p">[</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Convert to tuple if necessary</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="c1"># Check if axes has the right length</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ndim</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;axes should contain </span><span class="si">{</span><span class="n">ndim</span><span class="si">}</span><span class="s2"> dimensions, got </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Check if the last two values in axes are the spatial dimensions</span>
        <span class="k">if</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">!=</span> <span class="p">(</span><span class="n">y_dim</span><span class="p">,</span> <span class="n">x_dim</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot change the position of spatial dimensions. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;The last two axes must be </span><span class="si">{</span><span class="n">y_dim</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">x_dim</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Perform the transpose</span>
    <span class="n">transposed_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">transposed_values</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.valid_footprint" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">valid_footprint</span><span class="p">(</span><span class="n">crs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.valid_footprint" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>vectorizes the valid values of the GeoTensor and returns the footprint as a Polygon.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>crs</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Coordinate reference system. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>"all" or "any" to aggregate the channels of the image. Defaults to "all".</p>
              </div>
            </td>
            <td>
                  <code>&#39;all&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="shapely.geometry.MultiPolygon">MultiPolygon</span>, <span title="shapely.geometry.Polygon">Polygon</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Polygon or MultiPolygon: footprint of the GeoTensor.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">valid_footprint</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">crs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    vectorizes the valid values of the GeoTensor and returns the footprint as a Polygon.</span>

<span class="sd">    Args:</span>
<span class="sd">        crs (Optional[str], optional): Coordinate reference system. Defaults to None.</span>
<span class="sd">        method (str, optional): &quot;all&quot; or &quot;any&quot; to aggregate the channels of the image. Defaults to &quot;all&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Polygon or MultiPolygon: footprint of the GeoTensor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">valid_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">valid_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
                <span class="n">valid_values</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;any&quot;</span><span class="p">:</span>
            <span class="n">valid_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span>
                <span class="n">valid_values</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_values</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()),</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> to aggregate channels not implemented&quot;</span>
            <span class="p">)</span>

    <span class="kn">from</span> <span class="nn">georeader</span> <span class="kn">import</span> <span class="n">vectorize</span>

    <span class="n">polygons</span> <span class="o">=</span> <span class="n">vectorize</span><span class="o">.</span><span class="n">get_polygons</span><span class="p">(</span><span class="n">valid_values</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;GeoTensor has no valid values&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">pol</span> <span class="o">=</span> <span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pol</span> <span class="o">=</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">crs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pol</span>

    <span class="k">return</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">polygon_to_crs</span><span class="p">(</span><span class="n">pol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.validmask" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validmask</span><span class="p">()</span></code>

<a href="#georeader.geotensor.GeoTensor.validmask" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Returns a mask of the valid values of the GeoTensor. The mask is a boolean array
with the same shape as the GeoTensor values, where True indicates valid values and
False indicates invalid values.
The mask is created by comparing the values of the GeoTensor with the <code>self.fill_value_default</code>.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Self</code></td>            <td>
                  <code><span title="typing_extensions.Self">Self</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>GeoTensor with the valid boolean mask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">validmask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a mask of the valid values of the GeoTensor. The mask is a boolean array</span>
<span class="sd">    with the same shape as the GeoTensor values, where True indicates valid values and</span>
<span class="sd">    False indicates invalid values.</span>
<span class="sd">    The mask is created by comparing the values of the GeoTensor with the `self.fill_value_default`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Self: GeoTensor with the valid boolean mask.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">),</span>
            <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
            <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
            <span class="n">fill_value_default</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">GeoTensor</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_value_default</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">transform</span><span class="p">,</span>
        <span class="n">crs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span>
        <span class="n">fill_value_default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">attrs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="georeader.geotensor.GeoTensor.write_from_window" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_from_window</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span></code>

<a href="#georeader.geotensor.GeoTensor.write_from_window" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Writes array to GeoTensor values object at the given window position. If window surpasses the bounds of this
object it crops the data to fit the object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tensor to write. Expected: spatial dimensions <code>window.width</code>, <code>window.height</code>. Rest: same as <code>self</code></p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="rasterio.windows.Window">Window</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window object that specifies the spatial location to write the data</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span> <span class="o">=</span> <span class="n">GeoTensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">transform</span><span class="p">,</span> <span class="n">crs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">window</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span><span class="n">col_off</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">row_off</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">write_from_window</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>georeader/geotensor.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_from_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes array to GeoTensor values object at the given window position. If window surpasses the bounds of this</span>
<span class="sd">    object it crops the data to fit the object.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Tensor to write. Expected: spatial dimensions `window.width`, `window.height`. Rest: same as `self`</span>
<span class="sd">        window: Window object that specifies the spatial location to write the data</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; gt = GeoTensor(np.random.rand(3, 100, 100), transform, crs)</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(3, 50, 50)</span>
<span class="sd">        &gt;&gt;&gt; window = rasterio.windows.Window(col_off=7, row_off=9, width=50, height=50)</span>
<span class="sd">        &gt;&gt;&gt; gt.write_from_window(data, window)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">window_data</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span>
        <span class="n">col_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_off</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">intersect</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">window_data</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">assert</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="p">(</span>
        <span class="n">window</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
        <span class="n">window</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;window </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s2"> has different shape than data </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;Dimension of data in non-spatial channels found </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> expected: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="n">slice_dict</span><span class="p">,</span> <span class="n">pad_width</span> <span class="o">=</span> <span class="n">window_utils</span><span class="o">.</span><span class="n">get_slice_pad</span><span class="p">(</span><span class="n">window_data</span><span class="p">,</span> <span class="n">window</span><span class="p">)</span>
    <span class="n">slice_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span><span class="n">slice_dict</span><span class="p">)</span>
    <span class="c1"># need_pad = any(p != 0 for p in pad_width[&quot;x&quot;] + pad_width[&quot;y&quot;])</span>

    <span class="n">slice_data_spatial_x</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span>
        <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">slice_data_spatial_y</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span>
        <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">slice_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slice_tuple</span><span class="p">(</span>
        <span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">slice_data_spatial_x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">slice_data_spatial_y</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">slice_list</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">slice_data</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/spaceml-org/georeader" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/georeader-spaceml" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>